= foundry-vtt-types

[.text-center]
image::./media/img/league-logo-ts.svg[alt="League Logo TS", width=150]

Unofficial TypeScript type definitions for link:https://foundryvtt.com/[Foundry Virtual Tabletop].

[.text-center, frame="none", grid="none", stripes="none", width="300px", padding="0", margin="0"]
|===
a|image::https://img.shields.io/discord/732325252788387980?label=League%20of%20Extraordinary%20Foundry%20VTT%20Developers[link=https://discord.gg/52DNPzqm2Z, margin="0", padding="0"] a|image::https://img.shields.io/npm/v/@league-of-foundry-developers/foundry-vtt-types/latest[link=https://www.npmjs.com/package/@league-of-foundry-developers/foundry-vtt-types, margin="0", padding="0"]
|===

[CAUTION]
.Supported Foundry VTT Versions
====
These type definitions are designed to work with Foundry VTT versions #minimum version?# through #maximum version?#.
====

These type definitions enable full TypeScript type checking for the Foundry API.
This guide will walk you through setting up your Foundry project to use TypeScript with the `fvtt-types` type definitions.

.*What is TypeScript, and why should I use it?*
[%collapsible]
====
TypeScript is a developer-facing language based on JavaScript. Think of it like a "wrapper" around JavaScript that adds additional syntax and features to help you write better code, including static typing, enhanced tooling, and better support for modern programming practices.

Coding in TypeScript will help you spot errors earlier; make your code more robust, easier to navigate, and less vulnerable to error; and help make sure even complex refactors don't break everything.

A full introduction to TypeScript is beyond the scope of this document.
If you are new to coding with TypeScript, the *link:https://www.typescriptlang.org/docs/[official documentation]* includes several tutorials for programmers of all skill levels.
====

[discrete]
= Setting Up Your Foundry TypeScript Project

This process can be broadly divided into three steps:

. Preparing your project to use TypeScript.
. Preparing TypeScript to use the `fvtt-types` library of Foundry-specific type definitions.
. Configuring the `fvtt-types` library to match the requirements of your system or module.

The remainder of this guide will walk you through each of these steps.

[NOTE]
====
This is a *highly opinionated* guide. It is not intended to provide you with a complete understanding of the many different ways you could set up your TypeScript project, but rather to offer a quick, clear, and convenient recipe that should be more than enough for the majority of use cases.
====

== 1. Preparing Your Project to Use TypeScript

=== Installing the TypeScript Compiler

TypeScript is a language designed for developers, meaning it must be compiled into plain JavaScript before Foundry VTT can execute it.

To get started, you'll need to install the TypeScript compiler.
The easiest way to do this is via link:https://nodejs.org/en/download/package-manager[Node.js] and its package manager, `npm`. If you donâ€™t already have Node.js installed, download and install it from the provided link. Then, open your terminal and run the following command:

[source,console]
----
npm install -g typescript
----

To confirm the installation, you can check the compiler version by running:

[source,console]
----
tsc --version
----

This should display the version number of TypeScript, indicating it has been installed globally.

=== Initial Configuration: Your `tsconfig.json` File

TypeScript settings are defined in a `tsconfig.json` file, which should be located in the same folder as your project's `package.json` file. This file allows you to customize TypeScript's behavior, specify which files to compile and which types to include, and set up various compiler options.

Create a blank `tsconfig.json` file in your project's root directory, and copy the following code into it:

[source,json]
----
{
  "$schema": "https://json.schemastore.org/tsconfig.json",
  "compilerOptions": {
    "allowImportingTsExtensions": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": false,
    "module": "Node16",
    "moduleResolution": "Node16",
    "noEmit": true,
    "target": "ES2023",
    "outDir": "dist",
    "types": [],
    "verbatimModuleSyntax": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noUncheckedSideEffectImports": true,
    "useUnknownInCatchVariables": true,
    "noImplicitOverride": true
  },
  "references": [{ "path": "./src" }]
}
----

.*Explanations of the settings in the `tsconfig.json` file*
[%collapsible]
====
[horizontal]
allowImportingTsExtensions:: Allows your code to directly import TypeScript files using their `.ts` extensions, which is helpful when organizing your Foundry module's source files.
+
Setting this to *true* enables clearer imports in your module code, making it easier to track dependencies between files.

esModuleInterop:: Smooths out differences between how different module systems handle imports and exports, which is important because Foundry uses ES Modules for its module system.
+
Setting this to *true* helps prevent compatibility issues when importing Foundry's core libraries and other modules.

allowSyntheticDefaultImports:: Controls whether you can use simplified import syntax for modules that don't explicitly define default exports, which includes many Foundry API features.
+
Setting this to *false* ensures your imports match Foundry's module structure exactly, preventing subtle runtime errors.

module:: Determines how TypeScript handles module imports and exports in your code, which affects how your module interacts with Foundry's systems.
+
Setting this to *"Node16"* ensures compatibility with Foundry's modern JavaScript environment.

moduleResolution:: Controls how TypeScript locates imported files, which is crucial for properly resolving Foundry's API types and your module's own files.
+
Setting this to *"Node16"* matches Foundry's expected module resolution behavior.

noEmit:: Controls whether TypeScript should prevent the generation of JavaScript files during compilation.
+
Setting this to *true* tells TypeScript not to generate any JavaScript files. This may sound counterintuitive, but as you'll soon see, you'll be using Vite to generate your module's final JavaScript files, not the TypeScript compiler.

target:: Specifies which JavaScript version your TypeScript code should compile to, ensuring compatibility with Foundry's supported browser versions.
+
Setting this to *"ES2023"* allows you to use modern JavaScript features that Foundry supports.

outDir:: Specifies where your compiled JavaScript files should be placed relative to your source TypeScript files.
+
Setting this to *"dist"* ensures that your compiled JavaScript files are placed where they should be, in accordance with the file structure described #above (coming soon)#.

types:: Lists any additional type definition packages that should be included globally in your project. By default, TypeScript would automatically include all `@types` packages it can find in node_modules.
+
Setting this to an *empty array* prevents automatic type inclusion, letting you explicitly control which Foundry-related type definitions are included. This helps avoid conflicts between different type definition packages.

verbatimModuleSyntax:: Controls how TypeScript preserves your module import and export statements. This setting prevents TypeScript from rewriting or "down-leveling" your module syntax, ensuring that type imports and runtime imports remain exactly as written.
+
Setting this to *true* preserves your exact import/export statements in the compiled code, making it easier to understand how your module interacts with Foundry's systems both during development and at runtime.

forceConsistentCasingInFileNames:: Ensures that when you import files, the casing in your import statement must exactly match the actual filename. For example, `import "./MyFile.ts"` won't work if the file is actually named `myfile.ts`.
+
Setting this to *true* prevents bugs that could occur when your module runs on case-sensitive systems (like Linux) after being developed on case-insensitive systems (like Windows).

resolveJsonModule:: Allows you to import JSON files as modules, which is useful for handling Foundry's manifest files and data templates.
+
Setting this to *true* enables proper typing for your module's JSON configuration files.

strict:: Enables TypeScript's strictest type-checking options, helping catch common mistakes when working with Foundry's API.
+
Setting this to *true* provides the safest development environment for Foundry module development.

noUncheckedIndexedAccess:: Requires you to verify that array elements or object properties exist before using them. For example, when accessing items in an Actor's inventory or properties of a Document.
+
Setting this to *true* helps prevent runtime errors by forcing you to check whether values exist before trying to use them.

noUncheckedSideEffectImports:: Controls whether TypeScript allows importing files purely for their initialization effects (like registering hooks or adding properties to the global `game` object).
+
Setting this to *true* requires you to be explicit about imports that only initialize features rather than providing values, making your code's behavior more transparent.

useUnknownInCatchVariables:: Makes error variables in catch blocks have type 'unknown' instead of 'any', requiring you to verify what kind of error you caught before working with it.
+
Setting this to *true* ensures safer error handling by preventing you from assuming properties exist on caught errors without checking first.

noImplicitOverride:: Requires explicit marking of methods that override Foundry's base classes.
+
Setting this to *true* helps prevent accidental breaking changes when extending Foundry's document classes.
====
